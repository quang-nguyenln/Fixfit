{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { useNavigation } from '@react-navigation/native';\nimport React, { useState } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport { MaterialIcons } from '@expo/vector-icons';\nimport PickerModal from \"../PickerModal/PickerModal\";\nimport { useAuthentication } from \"../../utils/hooks/useAuthentication\";\nimport { storage, db, database } from \"../../config/firebase\";\nimport { ref, uploadBytes, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\nimport { setDoc, doc } from 'firebase/firestore';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar ImageCloset = function ImageCloset(_ref) {\n  var route = _ref.route;\n  var photo = route.params.photo;\n  var navigation = useNavigation();\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isVisible = _useState2[0],\n      setVisible = _useState2[1];\n\n  var _useAuthentication = useAuthentication(),\n      user = _useAuthentication.user;\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      uploading = _useState4[0],\n      setUploading = _useState4[1];\n\n  var savePhoto = function _callee(category) {\n    var dateTime, imageRef, img, bytes, uploadTask;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setUploading(true);\n            dateTime = Date.now() + '';\n            imageRef = ref(storage, user.email + \"/\" + category + \"/\" + dateTime);\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(fetch(photo.uri));\n\n          case 5:\n            img = _context.sent;\n            _context.next = 8;\n            return _regeneratorRuntime.awrap(img.blob());\n\n          case 8:\n            bytes = _context.sent;\n            _context.next = 11;\n            return _regeneratorRuntime.awrap(uploadBytesResumable(imageRef, bytes));\n\n          case 11:\n            uploadTask = _context.sent;\n            getDownloadURL(imageRef).then(function (downloadURL) {\n              try {\n                console.log('uploaded');\n                var postRef = doc(db, \"users\", user.email, category, dateTime);\n                setDoc(postRef, {\n                  name: dateTime,\n                  url: downloadURL\n                });\n              } catch (error) {\n                console.log(error);\n              }\n\n              setUploading(false);\n              navigation.navigate(category.replace('/', ''));\n            });\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var PostHeader = function PostHeader() {\n    var navigation = useNavigation();\n    return _jsxs(View, {\n      style: headerStyles.header,\n      children: [_jsx(Button, {\n        title: \"Cancel\",\n        onPress: function onPress() {\n          return navigation.navigate('Closet');\n        }\n      }), _jsx(Text, {\n        style: headerStyles.titleText,\n        children: \"Upload\"\n      }), _jsx(Button, {\n        title: \"Upload\",\n        onPress: function onPress() {\n          setVisible(true);\n        }\n      }), _jsx(PickerModal, {\n        title: \"Choose a category that you would like to save to.\",\n        isVisible: isVisible,\n        data: [\"Accessories\", \"Outerwear\", \"Tops\", \"Bottoms\", \"Dresses/Skirts\", \"Shoes\"],\n        onPress: function onPress(selectedItem) {\n          savePhoto(selectedItem);\n          setVisible(false);\n        },\n        onCancelPress: function onCancelPress() {\n          setVisible(false);\n        },\n        onBackdropPress: function onBackdropPress() {\n          setVisible(false);\n        }\n      })]\n    });\n  };\n\n  return _jsxs(SafeAreaView, {\n    style: styles.imagePrev,\n    children: [_jsx(PostHeader, {}), _jsx(View, {\n      style: {\n        marginVertical: 10,\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      children: uploading && _jsx(Text, {\n        style: {\n          color: 'gray'\n        },\n        children: \"Uploading in progress...\"\n      })\n    }), _jsx(ImageBackground, {\n      source: {\n        uri: photo && photo.uri\n      },\n      style: styles.itemPhoto\n    })]\n  });\n};\n\nvar headerStyles = StyleSheet.create({\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: 10,\n    height: '6%',\n    backgroundColor: '#fff',\n    borderBottomColor: '#808080',\n    borderBottomWidth: StyleSheet.hairlineWidth\n  },\n  titleText: {\n    fontSize: 18,\n    fontWeight: '600'\n  }\n});\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'center',\n    backgroundColor: '#fff'\n  },\n  sectionHeader: {\n    fontWeight: '700',\n    fontSize: 19,\n    color: '#000000',\n    marginTop: 20,\n    marginBottom: 10\n  },\n  item: {\n    paddingRight: 20\n  },\n  itemPhoto: {\n    width: '100%',\n    height: undefined,\n    aspectRatio: 1\n  },\n  itemText: {\n    color: '#000000',\n    marginTop: 5\n  },\n  imagePrev: {\n    backgroundColor: 'white',\n    flex: 1\n  },\n  cancelButton: {\n    position: 'absolute',\n    top: 60,\n    left: 20,\n    flex: 0.1,\n    color: '#fff'\n  },\n  secondScreen: {\n    position: 'absolute',\n    bottom: 55,\n    right: 20,\n    flex: 0.1,\n    color: '#fff'\n  },\n  test: {\n    position: 'absolute',\n    top: 65,\n    alignSelf: 'center',\n    flex: 0.1\n  },\n  text: {\n    fontSize: 20,\n    color: 'white'\n  }\n});\nexport default ImageCloset;","map":{"version":3,"names":["useNavigation","React","useState","MaterialIcons","PickerModal","useAuthentication","storage","db","database","ref","uploadBytes","uploadBytesResumable","getDownloadURL","setDoc","doc","ImageCloset","route","photo","params","navigation","isVisible","setVisible","user","uploading","setUploading","savePhoto","category","dateTime","Date","now","imageRef","email","fetch","uri","img","blob","bytes","uploadTask","then","downloadURL","console","log","postRef","name","url","error","navigate","replace","PostHeader","headerStyles","header","titleText","selectedItem","styles","imagePrev","marginVertical","justifyContent","alignItems","color","itemPhoto","StyleSheet","create","flexDirection","paddingHorizontal","height","backgroundColor","borderBottomColor","borderBottomWidth","hairlineWidth","fontSize","fontWeight","container","flex","sectionHeader","marginTop","marginBottom","item","paddingRight","width","undefined","aspectRatio","itemText","cancelButton","position","top","left","secondScreen","bottom","right","test","alignSelf","text"],"sources":["/Users/davidnguyen/Desktop/fixfit/components/Closet/ImageCloset.js"],"sourcesContent":["import { useNavigation } from '@react-navigation/native';\nimport React, { useState } from 'react';\nimport {\n  StyleSheet,\n  Text,\n  View,\n  ImageBackground,\n  TouchableOpacity,\n  Button,\n  SafeAreaView,\n} from 'react-native';\nimport {MaterialIcons } from '@expo/vector-icons';\nimport PickerModal from '../PickerModal/PickerModal';\nimport { useAuthentication } from '../../utils/hooks/useAuthentication';\nimport { storage, db, database } from '../../config/firebase';\nimport { ref, uploadBytes, uploadBytesResumable, getDownloadURL } from \"firebase/storage\";\nimport { setDoc, doc } from 'firebase/firestore'\n\n\nconst ImageCloset = ({route}) => {\n    const {photo} = route.params;\n    const navigation = useNavigation();\n    const [isVisible, setVisible] = useState(false);\n    const { user } = useAuthentication();\n    const [ uploading, setUploading ] = useState(false);\n    \n    const savePhoto = async (category) => {\n\n      setUploading(true);\n\n      const dateTime = Date.now() + '';\n      const imageRef = ref(storage, `${user.email}/${category}/${dateTime}`);\n\n      const img = await fetch(photo.uri);\n      const bytes = await img.blob();\n  \n      // uploadBytes(imageRef, bytes).then((snapshot) => {\n      //   console.log(\"Upload Successful.\");\n      // });\n\n      const uploadTask = await uploadBytesResumable(imageRef, bytes);\n\n      getDownloadURL(imageRef).then((downloadURL) => {\n        try {\n          console.log('uploaded');\n          const postRef = doc(db, \"users\", user.email, category, dateTime);\n          setDoc(postRef, {\n            name: dateTime,\n            url: downloadURL,\n          })\n        }\n        catch(error) {\n          console.log(error);\n        }\n        setUploading(false);\n        navigation.navigate(category.replace('/',''));\n      });\n    }\n\n    const PostHeader = () => {\n\n      const navigation = useNavigation();\n    \n      return (\n        <View style={headerStyles.header}>\n          <Button \n            title=\"Cancel\" \n            onPress={() => navigation.navigate('Closet')}\n          />\n          <Text style={headerStyles.titleText}>Upload</Text>\n          <Button \n            title=\"Upload\" \n            onPress={() => {\n                setVisible(true); \n            }}\n          />\n          <PickerModal\n            title=\"Choose a category that you would like to save to.\"\n            isVisible={isVisible}\n            data={[\"Accessories\", \"Outerwear\", \"Tops\", \"Bottoms\", \"Dresses/Skirts\", \"Shoes\"]}\n            onPress={(selectedItem) => {\n              savePhoto(selectedItem);\n              setVisible(false);\n            }}\n            onCancelPress={() => {\n              setVisible(false);\n            }}\n            onBackdropPress={() => {\n              setVisible(false);\n            }}\n          />\n        </View>\n      )\n    }\n\n    return (\n      <SafeAreaView style={styles.imagePrev}>\n        <PostHeader />\n          <View style={{ marginVertical: 10, justifyContent: 'center', alignItems: 'center' }}>\n                { uploading && <Text style={{ color: 'gray' }}>Uploading in progress...</Text> }\n          </View>\n\n        <ImageBackground\n          source={{uri: photo && photo.uri}}\n          style={styles.itemPhoto}\n        />\n      </SafeAreaView>\n    )\n};\n\nconst headerStyles = StyleSheet.create({\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: 10,\n    height: '6%',\n    backgroundColor: '#fff',\n    borderBottomColor: '#808080',\n    borderBottomWidth: StyleSheet.hairlineWidth,\n  },\n  titleText: {\n    fontSize: 18,\n    fontWeight: '600'\n  }\n})\n\nconst styles = StyleSheet.create({\n    container: {\n      flex: 1,\n      justifyContent: 'center',\n      backgroundColor: '#fff',\n    },\n    sectionHeader: {\n      fontWeight: '700',\n      fontSize: 19,\n      color: '#000000',\n      marginTop: 20,\n      marginBottom: 10,\n    },\n    item: {\n      paddingRight: 20\n    },\n    itemPhoto: {\n      width: '100%',\n      height: undefined,\n      aspectRatio: 1\n    },\n    itemText: {\n      color: '#000000',\n      marginTop: 5,\n    },\n    imagePrev: {\n      backgroundColor: 'white',\n      flex: 1,\n    },\n    cancelButton: {\n      position: 'absolute',\n      top: 60,\n      left: 20,\n      flex: 0.1,\n      color: '#fff',\n    },\n    secondScreen: {\n        position: 'absolute',\n        bottom: 55,\n        right: 20,\n        flex: 0.1,\n        color: '#fff',\n    },\n    test: {\n      position: 'absolute',\n      top: 65,\n      alignSelf: 'center',\n      flex: 0.1,\n    },\n    text: {\n        fontSize: 20,\n        color: 'white',\n    },\n  });\n\nexport default ImageCloset;"],"mappings":"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"},"metadata":{},"sourceType":"module"}